<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONNA VIBe - Detalhes do Produto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-sm navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="index.html">
                    <img src="img/logo.jpeg" alt="ONNA VIBe" height="40">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="mynavbar">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">HOME</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="medidas.html">CALCULAR MEDIDAS</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="catalogo.html">PRODUTOS</a>
                        </li>
                        <li class="nav-item">
  <li class="nav-item">
                            <a class="nav-link" href="index.html#contato-section">CONTATO</a>
                        </li>
                        </li>
                    </ul>
                    <div class="d-flex">
                        <a href="#" class="btn btn-outline-light" id="cartBtn">
                            üõí Carrinho (<span id="cartCount">0</span>)
                        </a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Conte√∫do do Produto -->
    <div class="container my-5" id="produtoDetalhe">
        <div class="row">
            <div class="col-md-6">
                <img id="produtoImagem" src="" class="img-fluid rounded" alt="Produto">
                <small class="text-muted mt-2 d-block">Clique na imagem para ampliar</small>
            </div>
            <div class="col-md-6">
                <h1 id="produtoNome">Carregando...</h1>
                <p id="produtoDescricao" class="lead"></p>
                <h3 class="text-danger" id="produtoPreco">R$ 0,00</h3>
                
                <!-- Cores dispon√≠veis -->
                <div class="mb-3">
                    <label class="form-label">Cor:</label>
                    <div id="coresContainer" class="d-flex gap-2">
                        <!-- Cores ser√£o carregadas pelo JavaScript -->
                    </div>
                </div>
                
                <!-- Tamanhos -->
                <div class="mb-3">
                    <label class="form-label">Tamanho:</label>
                    <select class="form-select" id="tamanhoSelect" style="max-width: 200px;">
                        <!-- Tamanhos ser√£o carregados pelo JavaScript -->
                    </select>
                </div>
                
                <!-- Quantidade -->
                <div class="mb-3">
                    <label class="form-label">Quantidade:</label>
                    <input type="number" id="quantidade" class="form-control" value="1" min="1" style="max-width: 100px;">
                </div>
                
                <!-- Bot√µes -->
                <button class="btn btn-dark btn-lg me-2" id="btnAdicionarCarrinho">
                    <i class="bi bi-cart-plus"></i> Adicionar ao Carrinho
                </button>
                <button class="btn btn-outline-dark btn-lg" id="btnComprarAgora">
                    <i class="bi bi-bag-check"></i> Comprar Agora
                </button>
                
                <!-- Voltar -->
                <div class="mt-4">
                    <a href="catalogo.html" class="text-decoration-none">
                        ‚Üê Voltar para o cat√°logo
                    </a>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center py-4">
        <p>¬© Todos os direitos reservados para ONNA VIBE</p>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/produtos-data.js"></script>
    <script src="js/main.js"></script>
    
    <!-- Script espec√≠fico para a p√°gina de detalhes -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // 1. Pegar o ID do produto da URL
        const urlParams = new URLSearchParams(window.location.search);
        const produtoId = urlParams.get('id');
        
        if (!produtoId) {
            mostrarErro('Produto n√£o encontrado!');
            return;
        }
        
        // 2. Buscar produto nos dados
        const produto = getProdutoPorId(parseInt(produtoId));
        
        if (!produto) {
            mostrarErro('Produto n√£o encontrado!');
            return;
        }
        
        // 3. Preencher os dados na p√°gina
        document.getElementById('produtoNome').textContent = produto.nome;
        document.getElementById('produtoDescricao').textContent = produto.descricao;
        document.getElementById('produtoPreco').textContent = `R$ ${produto.preco.toFixed(2).replace('.', ',')}`;
        
        // 4. Carregar imagem
        const imgElement = document.getElementById('produtoImagem');
        imgElement.src = produto.imagem;
        imgElement.alt = produto.nome;
        
        // Adicionar funcionalidade de zoom simples
        imgElement.onclick = function() {
            if (this.style.transform === 'scale(1.5)') {
                this.style.transform = 'scale(1)';
            } else {
                this.style.transform = 'scale(1.5)';
                this.style.transition = 'transform 0.3s ease';
                this.style.zIndex = '1000';
            }
        };
        
        // 5. Carregar cores
        const coresContainer = document.getElementById('coresContainer');
        if (produto.cores && produto.cores.length > 0) {
            produto.cores.forEach(cor => {
                const corBtn = document.createElement('button');
                corBtn.type = 'button';
                corBtn.className = 'btn btn-outline-dark btn-sm';
                corBtn.textContent = cor;
                corBtn.style.marginRight = '5px';
                corBtn.onclick = function() {
                    // Remover sele√ß√£o de todas as cores
                    document.querySelectorAll('#coresContainer button').forEach(btn => {
                        btn.classList.remove('btn-dark');
                        btn.classList.add('btn-outline-dark');
                    });
                    // Selecionar esta cor
                    this.classList.remove('btn-outline-dark');
                    this.classList.add('btn-dark');
                };
                coresContainer.appendChild(corBtn);
            });
       // Selecionar primeira cor por padr√£o
if (coresContainer.children.length > 0) {
    // Acessa o primeiro bot√£o de cor corretamente
    const primeiroBotaoCor = coresContainer.children[0];
    if (primeiroBotaoCor && primeiroBotaoCor.classList.contains('btn')) {
        primeiroBotaoCor.classList.remove('btn-outline-dark');
        primeiroBotaoCor.classList.add('btn-dark');
        console.log('Primeira cor selecionada:', primeiroBotaoCor.textContent);
    }
}
        }
        
        // 6. Carregar tamanhos
        const tamanhoSelect = document.getElementById('tamanhoSelect');
        tamanhoSelect.innerHTML = ''; // Limpar op√ß√µes padr√£o
        
        if (produto.tamanhos && produto.tamanhos.length > 0) {
            produto.tamanhos.forEach(tamanho => {
                const option = document.createElement('option');
                option.value = tamanho;
                option.textContent = tamanho;
                tamanhoSelect.appendChild(option);
            });
        } else {
            // Tamanhos padr√£o caso n√£o tenha no produto
            ['P', 'M', 'G', 'GG'].forEach(tamanho => {
                const option = document.createElement('option');
                option.value = tamanho;
                option.textContent = tamanho;
                tamanhoSelect.appendChild(option);
            });
        }
        
        // 7. Configurar bot√£o "Adicionar ao Carrinho"
        document.getElementById('btnAdicionarCarrinho').addEventListener('click', function() {
            const corSelecionada = document.querySelector('#coresContainer .btn-dark');
            const cor = corSelecionada ? corSelecionada.textContent : produto.cores[0];
            const tamanho = tamanhoSelect.value;
            const quantidade = parseInt(document.getElementById('quantidade').value);
            
            // Criar item do carrinho
            const itemCarrinho = {
                id: produto.id,
                nome: produto.nome,
                preco: produto.preco,
                imagem: produto.imagem,
                cor: cor,
                tamanho: tamanho,
                quantidade: quantidade
            };
            
            // Adicionar ao carrinho (usando fun√ß√£o do main.js)
            if (typeof adicionarAoCarrinho === 'function') {
                adicionarAoCarrinho(itemCarrinho);
            } else {
                // Fallback se a fun√ß√£o n√£o estiver dispon√≠vel
                let carrinho = JSON.parse(localStorage.getItem('carrinhoOnnaVibe')) || [];
                carrinho.push(itemCarrinho);
                localStorage.setItem('carrinhoOnnaVibe', JSON.stringify(carrinho));
                
                // Atualizar contador
                const cartCount = document.getElementById('cartCount');
                if (cartCount) {
                    const total = carrinho.reduce((sum, item) => sum + item.quantidade, 0);
                    cartCount.textContent = total;
                }
                
                alert(`‚úÖ ${produto.nome} adicionado ao carrinho!`);
            }
        });
        
        // 8. Configurar bot√£o "Comprar Agora"
        document.getElementById('btnComprarAgora').addEventListener('click', function() {
            // Primeiro adiciona ao carrinho
            document.getElementById('btnAdicionarCarrinho').click();
            
            // Depois redireciona para o WhatsApp
            setTimeout(() => {
                const nome = produto.nome;
                const preco = produto.preco;
                const tamanho = tamanhoSelect.value;
                const quantidade = document.getElementById('quantidade').value;
                
                const mensagem = `Ol√°! Gostaria de comprar o produto:\n\n` +
                                `*${nome}*\n` +
                                `Tamanho: ${tamanho}\n` +
                                `Quantidade: ${quantidade}\n` +
                                `Valor: R$ ${(preco * quantidade).toFixed(2)}\n\n` +
                                `Podem me ajudar?`;
                
                const mensagemCodificada = encodeURIComponent(mensagem);
                window.open(`https://wa.me/5511989693737?text=${mensagemCodificada}`, '_blank');
            }, 500);
        });
        
        function mostrarErro(mensagem) {
            document.getElementById('produtoDetalhe').innerHTML = `
                <div class="alert alert-danger text-center">
                    <h4>${mensagem}</h4>
                    <a href="catalogo.html" class="btn btn-dark mt-3">
                        Voltar para o cat√°logo
                    </a>
                </div>
            `;
        }
    });
    </script>
</body>
</html>
